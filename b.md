结合最终目标（自动生成《派驻检察室月度工作情况报告》），核心逻辑明确：**所有前端操作（表格填写、材料上传、数据录入）都是为了收集报告所需的29个核心字段，最终通过服务端自动抓取、统计这些字段，填充到报告模板中生成最终文档**。

以下是「字段拆解→前端收集方式→服务端自动生成逻辑」的全流程方案，确保每一步都精准对接报告需求：

### 一、先拆解报告核心字段（共29个，按报告章节分类）
| 报告章节                | 核心字段（需收集/统计）                                                                 | 字段类型       | 数据来源说明                                                                 |
|-------------------------|----------------------------------------------------------------------------------------|----------------|------------------------------------------------------------------------------|
| 一、本月基本情况        | 1.在押罪犯总数<br>2.重大刑事犯数<br>3.死缓犯数<br>4.无期犯数<br>5.二次以上判刑罪犯数<br>6.外籍犯数<br>7.港澳台罪犯数<br>8.精神病犯数<br>9.原地厅以上罪犯数<br>10.原县团级以上罪犯数<br>11.“法轮功”罪犯数<br>12.有吸毒史罪犯数<br>13.涉毒犯数<br>14.新收押罪犯数<br>15.未成年女犯数<br>16.涉黑罪犯数<br>17.涉恶罪犯数<br>18.危安罪犯数<br>19.记过罪犯数+原因<br>20.禁闭罪犯数+原因 | 数字/文本      | 主要来自“相关材料上传（数据抓取）”中的《本月入监人员花名册》《严管/禁闭人员花名册》《狱情动态文字材料》 |
| 二、执法检察情况        | 21.减刑审查案件批次+数量+阶段<br>22.纠正违法通知书份数+问题描述<br>23.三大现场检察次数<br>24.重点场所检察次数<br>25.会见检察次数+违法问题数 | 数字/文本      | 来自“周/月检察记录”“及时检察”“相关材料上传”，需统计+手动补充问题描述          |
| 三、安全防范检察        | 26.监控检察次数+发现问题数                                                             | 数字           | 来自“日检察”中“抽查监控记录”的统计（前端记录每次监控检察，服务端自动计数）    |
| 四、个别罪犯谈话情况    | 27.个别教育谈话总数（含新收/涉恶/外伤/禁闭罪犯分项数）<br>28.出监问卷调查表份数       | 数字           | 来自“周/月检察”中“谈话记录上传”的统计（按谈话类型分类计数）+ 问卷上传数量统计 |
| 五、参加会议/活动情况   | 29.各类会议次数（无期死缓评审会/减刑假释评审会/犯情分析会）+ 活动名称                   | 数字/文本      | 来自“月检察”中“参加会议/活动记录”（前端填写参会次数+活动名称，服务端汇总）    |
| 六、其他工作情况        | 30.开启检察官信箱次数<br>31.收到信件数                                                 | 数字           | 来自“周检察”中“检察官信箱记录”（前端填写每次开启情况，服务端计数）            |

### 二、前端（安卓平板网页端）如何收集这些字段？（精准对应，不冗余）
前端核心是「让检察人员通过简单操作，自动/手动录入字段」，避免重复填写，所有操作都对接上述字段：

#### 1. 自动抓取类字段（无需手动填，服务端从上传材料中提取）
对应“本月基本情况”中1-18项（罪犯分类数量），收集方式：
- 前端提供「材料上传入口」，让用户上传《本月入监人员花名册》《严管/禁闭人员花名册》《狱情动态文字材料》（按原需求文档要求）；
- 服务端通过EasyExcel解析花名册Excel，通过文本提取技术抓取狱情动态中的罪犯分类数据，自动统计出“在押总数、涉黑/涉恶罪犯数、新收押数”等18个字段；
- 前端仅需展示“待确认”数据（如服务端抓取到新收押5人，前端显示让用户核对），无需手动输入。

#### 2. 自动统计类字段（前端记录操作，服务端自动计数）
对应“监控检察次数、谈话总数、参会次数”等字段，收集方式：
- 「监控检察次数」：前端“日检察-抽查监控”模块，每记录1次监控检察，自动+1，服务端汇总月度总数；
- 「个别谈话总数」：前端“周检察-罪犯谈话”模块，每上传1份谈话笔录（按类型选择：新收/涉恶/外伤/禁闭），对应类型自动+1，服务端汇总总数和分项数；
- 「参会次数」：前端“月检察-参加会议”模块，提供下拉选择（无期死缓评审会/减刑假释评审会/犯情分析会），每选择1次参会记录，对应会议次数+1；
- 「问卷调查份数」：前端“材料上传-异常调查问卷”模块，每上传1份问卷，自动+1，服务端统计总数。

#### 3. 手动补充类字段（需用户填写，前端提供专用输入框）
对应“问题描述、纠正违法通知书份数”等文本/数字字段，收集方式：
- 「纠正违法问题+通知书份数」：前端“月检察-监管执法检察”模块，提供“问题描述输入框”和“通知书份数输入框”，用户填写后直接关联字段22；
- 「重点场所检察次数、会见检察次数」：前端“月检察-监管执法检察”模块，提供数字输入框（或下拉选择），填写后关联字段24、25；
- 「禁闭/记过原因」：前端“材料上传-严管/禁闭人员花名册”模块，上传花名册时，同步提供“原因填写框”，关联字段20；
- 「参加活动名称」：前端“月检察-参加活动”模块，提供文本输入框，填写监狱开展的活动名称，关联字段29。

#### 4. 前端操作界面简化设计（按报告章节对应模块）
| 前端核心模块                | 对应报告章节                | 核心操作                                                                 |
|-----------------------------|-----------------------------|--------------------------------------------------------------------------|
| 1. 基本信息导入模块          | 一、本月基本情况            | 上传花名册+狱情动态，核对服务端抓取的18个罪犯分类字段                    |
| 2. 执法检察记录模块          | 二、执法检察情况            | 填写减刑案件信息、违法问题描述、通知书份数，输入检察次数                  |
| 3. 安全防范记录模块          | 三、安全防范检察            | 记录每次监控检察，自动统计次数，填写发现问题数                            |
| 4. 谈话与问卷模块            | 四、个别罪犯谈话情况        | 上传谈话笔录（选择类型），自动统计分项数；上传问卷，自动统计份数          |
| 5. 会议/活动记录模块         | 五、参加会议/活动情况       | 选择参会类型（自动计数），填写活动名称                                    |
| 6. 其他工作记录模块          | 六、其他工作情况            | 填写开启检察官信箱次数、收到信件数                                        |

### 三、服务端（银河麒麟服务器）自动生成报告逻辑
1. **字段抓取与汇总**：
   - 从数据库中提取前端录入/统计的31个字段（如从“谈话记录表”统计新收押罪犯谈话数，从“监控记录表”统计监控检察次数）；
   - 从上传的材料中抓取补充字段（如从《减刑假释花名册》抓取案件批次+数量，从《纠正违法通知书》抓取份数+问题描述）。

2. **模板填充与格式生成**：
   - 基于提供的报告模板（Word格式），用Freemarker或Apache POI设置模板占位符（如`${在押罪犯总数}` `${纠正违法问题描述}`）；
   - 将汇总后的字段自动填充到占位符中，生成完整的Word文档；
   - 支持手动修改：生成后前端展示报告预览，用户可修改个别字段（如补充未自动抓取的细节），修改后重新生成最终版本。

3. **关联原需求的自动生成规则**：
   - 完全遵循原需求：“《月度工作情况报告》自动抓取数据生成，个别内容手动修改”；
   - 字段对应原需求的自动抓取来源：
     - 基本情况→狱情动态+花名册；
     - 减假暂办理情况→及时检察的减刑假释花名册；
     - 收押释放→入监/出监花名册；
     - 个别谈话数量→上传的谈话笔录附件数；
     - 调查问卷数量→上传的问卷份数。

### 四、关键保障：确保字段不遗漏、数据准确
1. **前端校验**：
   - 月度结束前，前端弹出“报告字段核对清单”，列出31个字段，未收集的字段标红提示（如“未填写纠正违法问题描述”），避免遗漏；
   - 数字字段限制非负整数（如罪犯数不能为负数），文本字段限制长度（如问题描述不超过500字）。

2. **数据溯源**：
   - 每个自动统计的字段，前端可查看“统计来源”（如“新收押罪犯谈话3人→来自3份新收押谈话笔录”），方便核对；
   - 手动填写的字段，记录填写人+填写时间，确保可追溯。

3. **离线场景适配**：
   - 离线时填写的字段（如谈话记录、检察次数）暂存本地，联网后自动同步到服务端，不影响字段收集；
   - 离线时无法自动抓取的字段（如花名册中的罪犯分类数），联网后服务端自动补全，无需用户二次操作。

### 五、最终流程闭环
1. 检察人员通过平板网页端完成：上传材料（花名册、笔录等）+ 记录操作（监控检察、参会、谈话）+ 补充填写（问题描述、原因等）；
2. 服务端自动汇总31个核心字段，填充到报告模板；
3. 前端展示报告预览，支持手动修改个别字段；
4. 生成最终的《派驻检察室月度工作情况报告》（Word格式），可下载、打印，或直接用于线上审阅、一键归档。

### 总结
整个方案的核心是「字段驱动」：所有功能设计都围绕“收集报告所需的31个字段”展开，前端操作简化为“上传+记录+补充”，服务端自动完成“统计+抓取+填充”，最终精准生成目标报告，完全满足需求。