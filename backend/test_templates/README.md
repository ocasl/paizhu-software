# 测试数据包

## 📦 包含内容

本目录包含完整的测试数据和说明文档，用于测试报告预览和清单功能。

### 文件清单

| 文件 | 说明 |
|------|------|
| `README.md` | 本文件 |
| `使用说明.md` | 详细的使用步骤和测试方法 |
| `测试文件说明.md` | 6个测试文件的数据格式说明 |

### 脚本清单

| 脚本 | 说明 |
|------|------|
| `scripts/insert-test-data.js` | 插入测试数据到数据库 |
| `scripts/clear-test-data.js` | 清理测试数据 |
| `scripts/test-data-priority.js` | 测试Excel数据优先级逻辑 |
| `scripts/test-data-isolation.js` | 测试数据隔离功能 |

---

## 🚀 快速开始

### 1. 插入测试数据

```bash
cd backend
node scripts/insert-test-data.js
```

**插入的数据：**
- 涉黑罪犯：3人
- 涉恶罪犯：2人
- 禁闭处分：3人
- 严管教育：4人
- 戒具使用：2人
- 信件数量：8封

### 2. 启动服务

**后端：**
```bash
npm start
```

**前端：**
```bash
cd ../front
npm run dev
```

### 3. 查看报告

1. 登录系统（admin/admin123）
2. 进入"报告预览"页面
3. 选择"2026年01月"
4. 查看统计数据

---

## ✅ 预期结果

在报告预览页面应该看到：

```
一、基本情况
  - 涉黑罪犯：3人
  - 涉恶罪犯：2人
  - 禁闭处分：3人
  - 记过处分：4人

六、其他工作
  - 收到信件：8封
```

---

## 🧪 测试场景

### 场景1：Excel数据优先

**测试步骤：**
1. 当前已有Excel数据（3个涉黑）
2. 在报告预览手动填写"涉黑罪犯：10人"
3. 保存后刷新页面

**预期结果：** 仍然显示3人（Excel数据优先）

### 场景2：数据隔离

**测试步骤：**
1. 创建两个不同派驻单位的用户
2. 分别上传不同的数据
3. 切换用户查看

**预期结果：** 每个用户只能看到自己派驻单位的数据

### 场景3：删除Excel数据

**测试步骤：**
1. 运行清理脚本：`node scripts/clear-test-data.js`
2. 刷新报告预览页面

**预期结果：** 
- 如果有手动填写的数据，显示手动填写的值
- 如果没有，显示0

---

## 📊 测试数据详情

### 1. 涉黑恶名单（5人）

| 编号 | 姓名 | 类型 | 罪名 |
|------|------|------|------|
| BL001 | 张三 | 涉黑 | 组织、领导黑社会性质组织罪 |
| BL002 | 李四 | 涉黑 | 参加黑社会性质组织罪 |
| BL003 | 王五 | 涉黑 | 包庇、纵容黑社会性质组织罪 |
| BL004 | 赵六 | 涉恶 | 寻衅滋事罪 |
| BL005 | 孙七 | 涉恶 | 强迫交易罪 |

### 2. 禁闭审批（3人）

| 编号 | 制单时间 | 违规事实 | 禁闭天数 |
|------|---------|---------|---------|
| CF001 | 2026-01-05 | 殴打他人 | 7天 |
| CF002 | 2026-01-10 | 拒不服从管理 | 7天 |
| CF003 | 2026-01-15 | 聚众闹事 | 7天 |

### 3. 严管教育（4人）

| 编号 | 制单时间 | 原因 | 天数 |
|------|---------|------|------|
| SE001 | 2026-01-03 | 违反监规 | 15天 |
| SE002 | 2026-01-08 | 不服从管理 | 10天 |
| SE003 | 2026-01-12 | 扰乱秩序 | 7天 |
| SE004 | 2026-01-20 | 打架斗殴 | 20天 |

### 4. 戒具使用（2人）

| 编号 | 制单时间 | 戒具名称 | 天数 |
|------|---------|---------|------|
| RU001 | 2026-01-06 | 手铐 | 3天 |
| RU002 | 2026-01-18 | 脚镣 | 5天 |

### 5. 信件汇总（8封）

| 序号 | 开箱日期 | 监区 | 事由 | 类别 |
|-----|---------|------|------|------|
| 1 | 2026-01-05 | 一监区 | 家庭问题咨询 | 一般信件 |
| 2 | 2026-01-08 | 二监区 | 申诉 | 申诉信件 |
| 3 | 2026-01-10 | 三监区 | 投诉 | 投诉信件 |
| 4 | 2026-01-12 | 一监区 | 生活问题 | 一般信件 |
| 5 | 2026-01-15 | 二监区 | 医疗问题 | 一般信件 |
| 6 | 2026-01-18 | 三监区 | 减刑咨询 | 一般信件 |
| 7 | 2026-01-22 | 一监区 | 申诉 | 申诉信件 |
| 8 | 2026-01-25 | 二监区 | 家属会见问题 | 一般信件 |

---

## 🔧 常用命令

```bash
# 插入测试数据
node scripts/insert-test-data.js

# 清理测试数据
node scripts/clear-test-data.js

# 测试数据优先级
node scripts/test-data-priority.js

# 测试数据隔离
node scripts/test-data-isolation.js

# 检查用户派驻单位
node scripts/check-user-prison-name.js
```

---

## 📝 相关文档

- [使用说明](./使用说明.md) - 详细的测试步骤
- [测试文件说明](./测试文件说明.md) - Excel文件格式说明
- [Excel数据统计说明](../../文档/Excel文件数据统计说明.md) - 数据统计逻辑
- [Excel数据优先级逻辑](../../文档/Excel数据优先级逻辑完成说明.md) - 优先级规则
- [数据隔离说明](../../文档/Excel数据按派驻单位隔离完成说明.md) - 数据隔离机制

---

## ❓ 常见问题

### Q1: 数据不显示？

**A:** 检查以下几点：
1. 用户是否设置了`prison_name`
2. 月份是否选择正确（2026-01）
3. 后端服务是否正常运行

### Q2: 数据不正确？

**A:** 
1. 清理旧数据：`node scripts/clear-test-data.js`
2. 重新插入：`node scripts/insert-test-data.js`
3. 刷新页面

### Q3: 如何创建真实的Excel文件？

**A:** 参考`测试文件说明.md`中的表格格式，使用Excel创建文件，然后通过前端"材料上传"页面上传。

---

## 📞 技术支持

如有问题，请查看：
- 后端日志：`backend/logs/`
- 前端控制台：浏览器开发者工具
- 数据库：直接查询相关表

---

**最后更新：** 2026-01-28
